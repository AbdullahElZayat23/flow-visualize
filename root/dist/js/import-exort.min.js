const importFileInput=document.getElementById("importFile"),externalFlow=document.getElementsByName("external-source")[0];function updateFlowVisualization(e){try{loader.style.display="block",setTimeout(()=>{globalThis.selectedFlow=e,renderGraph(),loader.style.display="none",showFeedBack({title:"Success!",text:"Render Success,  "+globalThis.renderTimeText,icon:"success",confirmButtonText:"Ok"}),document.querySelector(".nodeExample1:last-of-type")?.scrollIntoView({behavior:"smooth",block:"center"})},3e3)}catch(e){showFeedBack({title:"Error",text:"Render Fail",icon:"error"})}}function exportFlow(e,t={}){loader.style.display="block";try{var o,r,a,n,l=e||globalThis.selectedFlow;l?(o=JSON.stringify(l),r=new Blob([o],{type:"application/json"}),a=URL.createObjectURL(r),(n=document.createElement("a")).href=a,n.download=`${t?.name||l.name}-extracted | ${(new Date).toISOString()}.json`||"flow.json",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)):showFeedBack({title:"No data to export",text:"There is no data to export at the moment.",icon:"info"})}catch(e){showFeedBack({title:"Error",text:"Export Fail",icon:"error"})}finally{loader.style.display="none"}}function convertMongoDbTypesToJSON(r){return"object"!=typeof r||null===r?r:Array.isArray(r)?r.map(e=>convertMongoDbTypesToJSON(e)):Object.keys(r).reduce((e,t)=>{var o=r[t];if(o instanceof Date)e[t]=o;else if("function"==typeof o&&/^function\s+\w*\(\)\s+\{\s+\[native\s+code\]\s+\}$/.test(o.toString()))e[t]=o;else switch(o.constructor.name){case"ObjectID":e[t]=o.toString();break;case"NumberInt":e[t]=parseInt(o.valueOf());break;case"NumberDecimal":e[t]=parseFloat(o.valueOf());break;case"Date":e[t]=o.toISOString();break;default:e[t]=convertMongoDbTypesToJSON(o)}return e},{})}importFileInput.addEventListener("change",e=>{var e=e.target.files[0],t=new FileReader;t.addEventListener("load",e=>{try{var t=JSON.parse(e.target.result);t?.steps?.length?updateFlowVisualization(t):showFeedBack({title:"No Steps To Render",text:"There are no steps to render at the moment",icon:"info"})}catch(e){showFeedBack({title:"Error",text:"Failed to import JSON data. Please make sure the selected file contains valid / pure JSON data.",icon:"error"})}importFileInput.value=""}),t.onerror=function(){showFeedBack({title:"Error",text:"Error while reading the file",icon:"error"})},t.readAsText(e)}),externalFlow.addEventListener("change",e=>{var e=e.target.files[0],t=new FileReader;t.addEventListener("load",e=>{try{var t=JSON.parse(e.target.result);t?.steps?.length?globalThis.uploadedFileJSOnsData=t:showFeedBack({title:"No Data To Read",text:"There is no data to read in the selected file.",icon:"info"})}catch(e){showFeedBack({title:"Error",text:"Failed to import JSON data. Please make sure the selected file contains valid / pure JSON data.",icon:"error"})}externalFlow.value=""}),t.onerror=function(){showFeedBack({title:"Error",text:"Error while reading the file",icon:"error"})},t.readAsText(e)});