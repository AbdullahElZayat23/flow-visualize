const importFileInput=document.getElementById("importFile"),externalFlow=document.getElementsByName("external-source")[0];function updateFlowVisualization(e){try{loader.style.display="block",setTimeout(()=>{globalThis.selectedFlow=e,virhivKvetl(),loader.style.display="none",swal({title:"Success!",text:"Render Success,  "+globalThis.renderTimeText,icon:"success",button:"Ok"})},3e3)}catch(e){swal("Error","Render Fail","error")}}function exportFlow(e,t={}){loader.style.display="block";try{var r,a,o,l,n=e||globalThis.selectedFlow;n?(r=JSON.stringify(n),a=new Blob([r],{type:"application/json"}),o=URL.createObjectURL(a),(l=document.createElement("a")).href=o,l.download=`${t?.name||n.name}-extracted | ${(new Date).toISOString()}.json`||"flow.json",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(o)):swal({title:"No data to export",text:"There is no data to export at the moment.",icon:"info"})}catch(e){swal("Error","Export Fail","error")}finally{loader.style.display="none"}}function convertMongoDbTypesToJSON(a){return"object"!=typeof a||null===a?a:Array.isArray(a)?a.map(e=>convertMongoDbTypesToJSON(e)):Object.keys(a).reduce((e,t)=>{var r=a[t];if(r instanceof Date)e[t]=r;else if("function"==typeof r&&/^function\s+\w*\(\)\s+\{\s+\[native\s+code\]\s+\}$/.test(r.toString()))e[t]=r;else switch(r.constructor.name){case"ObjectID":e[t]=r.toString();break;case"NumberInt":e[t]=parseInt(r.valueOf());break;case"NumberDecimal":e[t]=parseFloat(r.valueOf());break;case"Date":e[t]=r.toISOString();break;default:e[t]=convertMongoDbTypesToJSON(r)}return e},{})}importFileInput.addEventListener("change",e=>{var e=e.target.files[0],t=new FileReader;t.addEventListener("load",e=>{try{var t=JSON.parse(e.target.result);t?.steps?.length?updateFlowVisualization(t):swal({title:"No Steps To Render",text:"There are no steps to render at the moment",icon:"info"})}catch(e){swal("Error","Failed to import JSON data. Please make sure the selected file contains valid / pure JSON data.","error")}importFileInput.value=""}),t.onerror=function(){swal("Error","Error While Reading The File","error")},t.readAsText(e)}),externalFlow.addEventListener("change",e=>{var e=e.target.files[0],t=new FileReader;t.addEventListener("load",e=>{try{var t=JSON.parse(e.target.result);t?.steps?.length?globalThis.uploadedFileJSOnsData=t:swal({title:"No Data To Read",text:"There is no data to read in the selected file.",icon:"info"})}catch(e){swal("Error","Failed to import JSON data. Please make sure the selected file contains valid / pure JSON data.","error")}externalFlow.value=""}),t.onerror=function(){swal("Error","Error While Reading The File","error")},t.readAsText(e)});