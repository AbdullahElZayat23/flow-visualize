const importFileInput=document.getElementById("importFile"),externalFlow=document.getElementsByName("external-source")[0];function updateFlowVisualization(e){try{loader.style.display="block",setTimeout(()=>{globalThis.selectedFlow=e,renderGraph(),loader.style.display="none",Swal.fire({title:"Success!",text:"Render Success,  "+globalThis.renderTimeText,icon:"success",button:"Ok"}),document.querySelector(".nodeExample1:last-of-type")?.scrollIntoView({behavior:"smooth",block:"center"})},3e3)}catch(e){Swal.fire({title:"Error",text:"Render Fail",icon:"error"})}}function exportFlow(e,t={}){loader.style.display="block";try{var r,o,a,l,n=e||globalThis.selectedFlow;n?(r=JSON.stringify(n),o=new Blob([r],{type:"application/json"}),a=URL.createObjectURL(o),(l=document.createElement("a")).href=a,l.download=`${t?.name||n.name}-extracted | ${(new Date).toISOString()}.json`||"flow.json",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)):Swal.fire({title:"No data to export",text:"There is no data to export at the moment.",icon:"info"})}catch(e){Swal.fire({title:"Error",text:"Export Fail",icon:"error"})}finally{loader.style.display="none"}}function convertMongoDbTypesToJSON(o){return"object"!=typeof o||null===o?o:Array.isArray(o)?o.map(e=>convertMongoDbTypesToJSON(e)):Object.keys(o).reduce((e,t)=>{var r=o[t];if(r instanceof Date)e[t]=r;else if("function"==typeof r&&/^function\s+\w*\(\)\s+\{\s+\[native\s+code\]\s+\}$/.test(r.toString()))e[t]=r;else switch(r.constructor.name){case"ObjectID":e[t]=r.toString();break;case"NumberInt":e[t]=parseInt(r.valueOf());break;case"NumberDecimal":e[t]=parseFloat(r.valueOf());break;case"Date":e[t]=r.toISOString();break;default:e[t]=convertMongoDbTypesToJSON(r)}return e},{})}importFileInput.addEventListener("change",e=>{var e=e.target.files[0],t=new FileReader;t.addEventListener("load",e=>{try{var t=JSON.parse(e.target.result);t?.steps?.length?updateFlowVisualization(t):Swal.fire({title:"No Steps To Render",text:"There are no steps to render at the moment",icon:"info"})}catch(e){Swal.fire({title:"Error",text:"Failed to import JSON data. Please make sure the selected file contains valid / pure JSON data.",icon:"error"})}importFileInput.value=""}),t.onerror=function(){Swal.fire({title:"Error",text:"Error while reading the file",icon:"error"})},t.readAsText(e)}),externalFlow.addEventListener("change",e=>{var e=e.target.files[0],t=new FileReader;t.addEventListener("load",e=>{try{var t=JSON.parse(e.target.result);t?.steps?.length?globalThis.uploadedFileJSOnsData=t:Swal.fire({title:"No Data To Read",text:"There is no data to read in the selected file.",icon:"info"})}catch(e){Swal.fire({title:"Error",text:"Failed to import JSON data. Please make sure the selected file contains valid / pure JSON data.",icon:"error"})}externalFlow.value=""}),t.onerror=function(){Swal.fire({title:"Error",text:"Error while reading the file",icon:"error"})},t.readAsText(e)});